---
title: "NGSadmix_angsd1"
author: "Julia Harenčár"
date: "2/25/2021"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.path = 'NGSadmix_figs/')
knitr::opts_knit$set(root.dir = '/Users/juliaharencar/Google Drive (jharenca@ucsc.edu)/Costus/Seq_analysis/ANGSD')
```
 This markdown summarizes the admixture plots I generated by running NGSadmix on the genotype likelihood (beagle) file output of angsd run 1, which uses samtools as the variant caller (see AVHonly_ANGSD1_beagles.slurm in angsd_runs/).
 
#### Admixture plot of alle, vill, and hybrids only

Plot created from output of the following code:\
`NGSadmix -likes $IN_DIR/AVH_only.genolike.beagle.gz -K 2 -P 48 -o $OUT_DIR/AVH_only_NGSadmix_out -minMaf 0.05`


```{r angsd1_AVH_admixture, fig.width = 5, fig.height = 5, echo=FALSE}

# Get ID and pop info for each individual
pop<-scan("angsd_out/AVH_only.poplabel", what="theFuck")

# Read inferred admixture proportions file
q<-read.table("angsd_out/NGSadmix/AVH_only_NGSadmix_out.qopt")

# Plot them (ordered by population)
ord = order(pop)
par(mar=c(7,4,1,1))
barplot(t(q)[,ord],col=c("red","yellow"),names=pop[ord],las=2,ylab="AVH Admixture proportions",cex.names=0.75)
#quartz.save("NGSadmix_figs/AVH_only_admixture_plot", type="png")

```

#### Admixture plot of laev, guan, alle, vill, and hybrids

Plot created from output of the following code:\
`NGSadmix -likes $IN_DIR/L.G.A.V.H.genolike.beagle.gz -K 4 -P 48 -o $OUT_DIR/LGAVH_NGSadmix_out -minMaf 0.05`


```{r angsd1_LGAVH_K4_admixture, fig.width = 12, fig.height = 5, echo=FALSE}

# Get ID and pop info for each individual
pop2<-scan("angsd_out/LGAVH.poplabel", what="theFuck")

# Read inferred admixture proportions file
q2<-read.table("angsd_out/NGSadmix/LGAVH_NGSadmix_out.qopt")

# Plot them (ordered by population)
ord2 = order(pop2)
par(mar=c(7,4,1,1))
barplot(t(q2)[,ord2],col=c("blue","purple", "yellow", "red"),names=pop2[ord2],las=2,ylab="LGAVH Admixture proportions",cex.names=0.75)
#quartz.save("NGSadmix_figs/AVH_only_admixture_plot", type="png")

```

Plot created from output of the following code:\
`NGSadmix -likes $IN_DIR/L.G.A.V.H.genolike.beagle.gz -K 5 -P 48 -o $OUT_DIR/LGAVH_NGSadmix_out -minMaf 0.05`


```{r angsd1_LGAVH_K5_admixture, fig.width = 12, fig.height = 5, echo=FALSE}

# Get ID and pop info for each individual
pop3<-scan("angsd_out/LGAVH.poplabel", what="theFuck")

# Read inferred admixture proportions file
q3<-read.table("angsd_out/NGSadmix/LGAVH_K5_NGSadmix_out.qopt")

# Plot them (ordered by population)
ord3 = order(pop3)
par(mar=c(7,4,1,1))
barplot(t(q3)[,ord3],col=c("blue","purple", "yellow", "red", "green"),names=pop3[ord3],las=2,ylab="LGAVH Admixture proportions (K5)",cex.names=0.75)
#quartz.save("NGSadmix_figs/AVH_only_admixture_plot", type="png")

```

Plot created from output of the following code:\
`NGSadmix -likes $IN_DIR/L.G.A.V.H.genolike.beagle.gz -K 6 -P 48 -o $OUT_DIR/LGAVH_NGSadmix_out -minMaf 0.05`


```{r angsd1_LGAVH_K6_admixture, fig.width = 12, fig.height = 5, echo=FALSE}

# Get ID and pop info for each individual
pop4<-scan("angsd_out/LGAVH.poplabel", what="theFuck")

# Read inferred admixture proportions file
q4<-read.table("angsd_out/NGSadmix/LGAVH_K6_NGSadmix_out.qopt")

# Plot them (ordered by population)
ord4 = order(pop4)
par(mar=c(7,4,1,1))
barplot(t(q4)[,ord4],col=c("blue","purple", "yellow", "red", "green", "orange"),names=pop4[ord4],las=2,ylab="LGAVH Admixture proportions (K6)",cex.names=0.75)
#quartz.save("NGSadmix_figs/AVH_only_admixture_plot", type="png")

```

#### Admixture plot of guan, alle, vill, and hybrids

Plot created from output of the following code:\
`NGSadmix -likes $IN_DIR/GAVH.genolike.beagle.gz -K 3 -P 48 -o $OUT_DIR/LGAVH_NGSadmix_out -minMaf 0.05`


```{r angsd1_GAVH_K3_admixture, fig.width = 12, fig.height = 5, echo=FALSE}

# Get ID and pop info for each individual
pop5<-scan("angsd_out/GAVH.poplabel", what="theFuck")

# Read inferred admixture proportions file
q5<-read.table("angsd_out/NGSadmix/GAVH_K3_NGSadmix_out.qopt")

# Plot them (ordered by population)
ord5 = order(pop5)
par(mar=c(7,4,1,1))
barplot(t(q5)[,ord5],col=c("purple", "yellow", "red"),names=pop5[ord5],las=2,ylab="GAVH Admixture proportions (K3)",cex.names=0.75)
#quartz.save("NGSadmix_figs/AVH_only_admixture_plot", type="png")

```